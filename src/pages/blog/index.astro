---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
---

<Layout title="Blog | Dev Portfolio_">
    <section class="grid md:grid-cols-12 border-b border-neutral-800">
        <div class="md:col-span-3 py-12 px-6 md:px-8 border-b md:border-b-0 md:border-r border-neutral-800 bg-neutral-900/20">
            <h2 class="font-mono text-xs text-neutral-500 uppercase tracking-widest sticky top-24">04 â€” Blog</h2>
        </div>

        <div class="md:col-span-9">
            <ul class="flex flex-col">
                {posts.map(post => (
                    <li class="blog-card group border-b border-neutral-800 hover:bg-neutral-900/30 transition-colors duration-150">
                        <article class="p-6 md:p-10 flex flex-col gap-6">
                            <div class="flex justify-between items-start">
                                <h3 class="text-2xl text-white font-medium group-hover:text-emerald-400 transition-colors">
                                    <a href={`/blog/${post.slug}`}>{post.data.title}</a>
                                </h3>
                                <a href={`/blog/${post.slug}`} class="font-mono text-xs text-emerald-500 border border-emerald-500 px-3 py-1 hover:bg-emerald-500 hover:text-black transition-colors uppercase" aria-label={`Read ${post.data.title}`}>
                                    Read Post
                                </a>
                            </div>
                            {post.data.description && (
                                <p class="text-neutral-400 max-w-2xl">
                                    {post.data.description}
                                </p>
                            )}
                            <div class="flex flex-wrap gap-x-6 gap-y-2 font-mono text-xs text-neutral-500 uppercase tracking-wider">
                                <time datetime={new Date(post.data.pubDate || Date.now()).toISOString()}>
                                    [ {new Date(post.data.pubDate || Date.now()).toLocaleDateString()} ]
                                </time>
                            </div>
                        </article>
                    </li>
                ))}
            </ul>
            
            {posts.length === 0 && (
                <div class="p-12 text-neutral-500 font-mono">
                    // No posts found.
                </div>
            )}
        </div>
    </section>
</Layout>
